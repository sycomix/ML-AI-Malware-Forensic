#import subprocess
import os
import sys

#!/usr/local/bin/python3.1
import subprocess
#oper = ['hivelist', 'pstree', 'pslist', 'cmdscan', 'connections', 'idt', 'imageinfo', 'svcscan', 'symlinkscan']
oper = ['psxview','malfind','eventhooks','apihooks','messagehooks']
#mem = input("Memory Dump File: ")
mem=sys.argv[1]
for x in oper:
 if x!="psxview":
  command = ("/root/volatility/vol.py " + x + " -f "+mem+" --output-file=" +x+mem+".text " " --output=text")
 else:
  command = ("/root/volatility/vol.py " + x + " -f "+mem+" --output-file=" +x+mem+".xlsx " " --output=xlsx "" --apply-rules")

 subprocess.call(command, shell=True)
